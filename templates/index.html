<!DOCTYPE html>
{% load staticfiles %}
<html>
<head>
    <title>Simple Player Analysis & Draft Engine</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CDN for Bootstrap 3.2.0 -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <!-- CDN for AngularJS 1.2.18 -->
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.18/angular.min.js"></script>

    <!-- Staticfiles loading for our local css -->
    <link rel="stylesheet" href="{% static "css/base.css" %}">
    <link rel="stylesheet" href="{% static "css/players.css" %}">
    <link rel="stylesheet" href="{% static "css/modal.css" %}">

    <!-- Staticfiles loading for our local javascript -->
    <script src="{% static "javascript/app.js" %}"></script>
    <script src="{% static "javascript/controllers.js" %}"></script>
    <script src="{% static "javascript/services.js" %}"></script>
</head>
<body ng-app="PlayersApp" ng-controller="playersController">
    <div class="col-md-9 col-lg-9 playersColumn">
        <div class="jumbotron">
            <div align="center" class="container">
                <h1>Welcome to SPADE!</h1>
                <p>Otherwise known as the <b>S</b>imple <b>P</b>layer <b>A</b>nalysis & <b>D</b>raft <b>E</b>ngine</p>
                <p>* All stats collected are from the 2013 season</p>
                <a href="/draft_board" target="_blank">Go to draft board</a>
            </div>
        </div>
        <div class="tableHolder">
            <div class="filters">
                <div class="searchBox">
                    <input type="text" ng-model="search.name" placeholder="Search Name" class="form-control">
                </div>
                <div class="filterSelect">
                    <label>Position:&nbsp;
                        <select ng-model="search.position">
                            <option value="">All</option>
                            <option ng-repeat="position in positions" value="{[{position}]}">{[{position}]}</option>
                        </select>
                    </label>
                </div>
                <div class="filterSelect">
                    <label>NFL Team:&nbsp;
                        <select ng-model="search.nfl_team">
                            <option value="">All</option>
                            <option ng-repeat="(short,long) in nflTeams" value="{[{short}]}">{[{long}]}</option>
                        </select>
                    </label>
                </div>
                <div class="filterSelect">
                    <label>Availability:&nbsp;
                        <select ng-model="search.available">
                            <option value="">All</option>
                            <option value="true">Only Available</option>
                            <option value="false">Only Unavailable</option>
                        </select>
                    </label>
                </div>
                <div class="filterSelect">
                    <label>Tagged:&nbsp;
                        <select ng-model="search.tagged">
                            <option value="">All</option>
                            <option value="true">Tagged</option>
                            <option value="false">Untagged</option>
                        </select>
                    </label>
                </div>
            </div>
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Tag</th>
                        
                        <!-- Common to all players -->
                        <th ng-class="{'sorted': predicate == 'name'}">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'name'; reverse = !reverse">
                                Name
                                <span ng-class="{'caret': predicate == 'name', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'position'}">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'position'; reverse = !reverse">
                                Pos
                                <span ng-class="{'caret': predicate == 'position', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'nfl_team'}">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'nfl_team'; reverse = !reverse">
                                NFL Team
                                <span ng-class="{'caret': predicate == 'nfl_team', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'games_played'}">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'games_played'; reverse = !reverse">
                                Games
                                <span ng-class="{'caret': predicate == 'games_played', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'espn_ranking'}">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'espn_ranking'; reverse = !reverse">
                                ESPN Rank
                                <span ng-class="{'caret': predicate == 'espn_ranking', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'last_season_points'}">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'last_season_points'; reverse = !reverse">
                                2013 Points
                                <span ng-class="{'caret': predicate == 'last_season_points', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'league_team'}">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'league_team'; reverse = !reverse">
                                League Team
                                <span ng-class="{'caret': predicate == 'league_team', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        
                        <!-- QB stats -->
                        <th ng-class="{'sorted': predicate == 'stats.passing_yards'}" ng-show="search.position == 'QB'">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'stats.passing_yards'; reverse = !reverse">
                                Passing Yards
                                <span ng-class="{'caret': predicate == 'stats.passing_yards', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'stats.passing_touchdowns'}" ng-show="search.position == 'QB'">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'stats.passing_touchdowns'; reverse = !reverse">
                                Passing touchdowns
                                <span ng-class="{'caret': predicate == 'stats.passing_touchdowns', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'stats.interceptions'}" ng-show="search.position == 'QB'">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'stats.interceptions'; reverse = !reverse">
                                Interceptions
                                <span ng-class="{'caret': predicate == 'stats.interceptions', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        
                        <!-- RB stats -->
                        <th ng-class="{'sorted': predicate == 'stats.rushing_yards'}" ng-show="search.position == 'RB'">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'stats.rushing_yards'; reverse = !reverse">
                                Rushing Yards
                                <span ng-class="{'caret': predicate == 'stats.rushing_yards', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'stats.rushing_touchdowns'}" ng-show="search.position == 'RB'">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'stats.rushing_touchdowns'; reverse = !reverse">
                                Rushing Touchdowns
                                <span ng-class="{'caret': predicate == 'stats.rushing_touchdowns', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>

                        <!-- WR/TE stats -->
                        <th ng-class="{'sorted': predicate == 'stats.receiving_yards'}" ng-show="search.position == 'WR'">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'stats.receiving_yards'; reverse = !reverse">
                                Receiving Yards
                                <span ng-class="{'caret': predicate == 'stats.receiving_yards', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                        <th ng-class="{'sorted': predicate == 'stats.receiving_touchdowns'}" ng-show="search.position == 'WR'">
                            <div class="sortableHeader noSelect" ng-click="predicate = 'stats.receiving_touchdowns'; reverse = !reverse">
                                Receiving Touchdowns
                                <span ng-class="{'caret': predicate == 'stats.receiving_touchdowns', 'caret-reversed': reverse}"></span>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="player in playersList | orderBy:predicate:reverse | filter:search:strict"
                        ng-class="{'bg-danger': !player.available, 'bg-warning': player.tagged}">
                        <td ng-click="player.tagged = player.available ? !player.tagged : false" ng-class="{'tagBox': player.available}" class="noSelect">
                            <input type="checkbox" ng-checked="player.tagged" ng-disabled="!player.available">
                        </td>
                        
                        <!-- Common to all players -->
                        <td ng-class="{'sorted': predicate == 'name'}">
                            <span class="clickable" ng-click="showModal(player)">{[{player.name}]}</span>
                        </td>
                        <td ng-class="{'sorted': predicate == 'position'}">{[{player.position}]}</td>
                        <td ng-class="{'sorted': predicate == 'nfl_team'}">{[{player.nfl_team}]}</td>
                        <td ng-class="{'sorted': predicate == 'games_played'}">{[{player.games_played}]}</td>
                        <td ng-class="{'sorted': predicate == 'espn_ranking'}">{[{player.espn_ranking}]}</td>
                        <td ng-class="{'sorted': predicate == 'last_season_points'}">{[{player.last_season_points}]}</td>
                        <td ng-class="{'sorted': predicate == 'league_team'}">{[{player.league_team}]}</td>

                        <!-- QB stats -->
                        <td ng-class="{'sorted': predicate == 'stats.passing_yards'}" ng-show="search.position == 'QB'">{[{player.stats.passing_yards}]}</td>
                        <td ng-class="{'sorted': predicate == 'stats.passing_touchdowns'}" ng-show="search.position == 'QB'">{[{player.stats.passing_touchdowns}]}</td>
                        <td ng-class="{'sorted': predicate == 'stats.interceptions'}" ng-show="search.position == 'QB'">{[{player.stats.interceptions}]}</td>

                        <!-- RB stats -->
                        <td ng-class="{'sorted': predicate == 'stats.rushing_yards'}" ng-show="search.position == 'RB'">{[{player.stats.rushing_yards}]}</td>
                        <td ng-class="{'sorted': predicate == 'stats.rushing_touchdowns'}" ng-show="search.position == 'RB'">{[{player.stats.rushing_touchdowns}]}</td>

                        <!-- WR stats -->
                        <td ng-class="{'sorted': predicate == 'stats.receiving_yards'}" ng-show="search.position == 'WR'">{[{player.stats.receiving_yards}]}</td>
                        <td ng-class="{'sorted': predicate == 'stats.receiving_touchdowns'}" ng-show="search.position == 'WR'">{[{player.stats.receiving_touchdowns}]}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="col-md-3 col-lg-3 teamList">
        <div class="filters" align="center">
            <div class="teamFilterSelect">
                <label>Select Team:&nbsp;
                    <select ng-model="selectedLeagueTeam">
                        <option ng-repeat="(short,long) in leagueTeams" value="{[{short}]}">{[{long}]}</option>
                    </select>
                </label>
            </div>
        </div>
        <div class="teamPlayer" ng-repeat="position in leaguePositions">
            <span class="playerPosition">{[{position}]}</span>
            <span class="playerName">{[{getTeamPosition(selectedLeagueTeam, position).name}]}</span>
        </div>
        <div class="teamListCounts fixedFooter">
            <b>TOTALS:&nbsp</b>
            <span ng-repeat="position in positions" class="playerCount">
                {[{position}]}: {[{getTeamPositionPlayerCount(selectedLeagueTeam, position)}]}
            </span>
        </div>
    </div>
    <modal-dialog show="modalShown">
        <div class="statsHolder">
            <table class="table-hover table-bordered" style="padding: 5px">
                <thead>
                    <tr class="filters">
                        <td colspan="2" style="font-weight: bold; text-align: center; padding: 10px">
                            {[{modalPlayer.name}]} - {[{modalPlayer.position}]} - Stats
                        </td>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="(key, value) in modalPlayer.stats">
                        <td style="font-weight: bold; padding: 2px">{[{convertFieldToHeader(key)}]}</td>
                        <td style="padding: 2px; text-align: right">{[{value}]}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </modal-dialog>
</body>
</html>