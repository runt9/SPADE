doctype html
html
    head
        include commonHeader
        script(src='/js/service/draftService.js')
        script(src='/js/controller/draftController.js')
        link(rel='stylesheet', href='/css/draft.css')

    body(ng-app='SpadeApp', ng-controller='DraftController as ctrl')
        .loadingIndicator.absoluteCenterAll(ng-show='loading')
            span.loadingIndicatorHelper
            i.fa.fa-spin.fa-spinner
        .col-xs-12.col-sm-12.col-md-9.col-lg-9.playersColumn
            h2.text-center(ng-cloak) Welcome to the {{ ctrl.year }} {{ ctrl.draft.leagueName }} draft!
            .tableHolder
                .filters
                    .searchBox
                        input.form-control(type='text', ng-model='ctrl.search.player.name', placeholder='Search Name')
                    .filterSelect
                        label
                            | Position: 
                            select(ng-model='ctrl.search.player.position.id')
                                option(value='') All
                                option(ng-repeat='pos in ctrl.possiblePositions', value='{{ pos.id }}') {{ pos.abbr }}
                    .filterSelect
                        label
                            | NFL Team: 
                            select(ng-model='ctrl.search.player.nflTeam.id')
                                option(value='') All
                                option(ng-repeat='team in ctrl.nflTeams', value='{{ team.id }}') {{ team.city + ' ' + team.nickName }}
                    .filterSelect
                        label
                            | Availability: 
                            select(ng-model='ctrl.search.available')
                                option(value='') All
                                option(value='true') Only Available
                                option(value='false') Only Unavailable
                    .filterSelect
                        label
                            | Tagged: 
                            select(ng-model='ctrl.search.tagged')
                                option(value='') All
                                option(value='true') Tagged
                                option(value='false') Untagged
                table.table.table-hover
                    thead
                        tr
                            th Tag
                            // Common to all players
                            th(ng-class="{'sorted': predicate == 'player.name'}")
                                .sortableHeader.noSelect(ng-click="predicate = 'player.name'; reverse = !reverse")
                                    | Name
                                    span(ng-class="{'caret': predicate == 'player.name', 'caret-reversed': reverse}")
                            th(ng-class="{'sorted': predicate == 'player.position.abbr'}")
                                .sortableHeader.noSelect(ng-click="predicate = 'player.position.abbr'; reverse = !reverse")
                                    | Pos
                                    span(ng-class="{'caret': predicate == 'player.position.abbr', 'caret-reversed': reverse}")
                            th(ng-class="{'sorted': predicate == 'player.nflTeam.abbr'}")
                                .sortableHeader.noSelect(ng-click="predicate = 'player.nflTeam.abbr'; reverse = !reverse")
                                    | NFL Team
                                    span(ng-class="{'caret': predicate == 'player.nflTeam.abbr', 'caret-reversed': reverse}")
                            th(ng-class="{'sorted': predicate == 'player.nflTeam.byeWeek'}")
                                .sortableHeader.noSelect(ng-click="predicate = 'player.nflTeam.byeWeek'; reverse = !reverse")
                                    | Bye
                                    span(ng-class="{'caret': predicate == 'player.nflTeam.byeWeek', 'caret-reversed': reverse}")
                            th(ng-class="{'sorted': predicate == 'player.team.abbr'}")
                                .sortableHeader.noSelect(ng-click="predicate = 'player.team.abbr'; reverse = !reverse")
                                    | Bye
                                    span(ng-class="{'caret': predicate == 'player.team.abbr', 'caret-reversed': reverse}")
                    tbody
                        tr(ng-repeat='player in ctrl.draft.draftPlayers | orderBy:predicate:reverse | filter:ctrl.search', ng-class="{'bg-danger': !ctrl.isPlayerAvailable(player), 'bg-warning': player.tagged}")
                            td.noSelect(ng-click='player.tagged = player.available ? !player.tagged : false', ng-class="{'tagBox': ctrl.isPlayerAvailable(player)}")
                                input(type='checkbox', ng-checked='player.tagged', ng-disabled='!ctrl.isPlayerAvailable(player)')
                            // Common to all players
                            td(ng-class="{'sorted': predicate == 'player.name'}")
                                span(ng-class='{clickable: authorized}', ng-click='authorized && playerClicked(this)') {{ player.player.name }}
                            td(ng-class="{'sorted': predicate == 'player.position.abbr'}") {{ player.player.position.abbr }}
                            td(ng-class="{'sorted': predicate == 'player.nflTeam.abbr'}") {{ player.player.nflTeam.abbr }}
                            td(ng-class="{'sorted': predicate == 'player.nflTeam.byeWeek'}") {{ player.player.nflTeam.byeWeek }}
                            td(ng-class="{'sorted': predicate == 'player.team.abbr'}") {{ player.team.abbr }}
        .col-xs-8.col-sm-5.col-md-3.col-lg-3.teamList.offCanvas(ng-class='{activeSidebar: sidebarActive}')
            .filters(align='center')
                button.closeSidebar.btn.btn-default.btn-xs(ng-click='sidebarActive = !sidebarActive') X
                .teamFilterSelect
                    label
                        | Select Team: 
                        select(ng-model='ctrl.selectedLeagueTeam', ng-options='team as team.name for team in ctrl.draft.fantasyTeams track by team.id')
            .teamPlayer(ng-repeat='pos in ctrl.teamPositions track by $index')
                span.playerPosition {{ pos.abbr }}
                span.byeWeek {{ getTeamPosition(selectedLeagueTeam, position).bye_week }}
                span.playerName {{ getTeamPosition(selectedLeagueTeam, position).name }}
            .teamListCounts.fixedFooter
                b TOTALS:&nbsp
                span.playerCount(ng-repeat='pos in ctrl.possiblePositions')
                    | {{ pos.abbr }}: {{getTeamPositionPlayerCount(selectedLeagueTeam, position) }}